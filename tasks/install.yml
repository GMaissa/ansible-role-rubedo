---
- include: install-RedHat.yml
  when: ansible_os_family == 'RedHat'

- include: install-Debian.yml
  when: ansible_os_family == 'Debian'

- name: Install PECL extensions
  shell: printf "\n" | pecl install {{ item }}
  with_items: rubedo_pecl.extensions
  register: pecl_installs
  ignore_errors: yes

- name: Configure PHP to use PECL extensions
  shell: echo "extension={{ item.item }}.so" > {{ rubedo_pecl.conf_dir }}/{{ item.item }}.ini
  when: item.rc != 1
  with_items: pecl_installs.results
  notify: Restart Apache
